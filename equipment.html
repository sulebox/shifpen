<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë£ÖÂÇô„Çπ„ÉÜ„Éº„Çø„ÇπË°®</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #111827; 
            color: #d1d5db; 
        }
        .table-container {
            background-color: #1f2937; 
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
            overflow-x: auto; 
            max-height: 90vh; 
        }
        .status-table {
            table-layout: fixed; 
            width: auto; 
            min-width: 100%; 
        }
        thead th {
            position: sticky;
            background-color: #374151; 
            z-index: 20; 
        }
        thead tr:first-child th { 
            top: 0;
            z-index: 22; 
        }
        thead tr:nth-child(2) th { 
            top: 41px; 
            z-index: 21; 
        }
        th.sticky-col { 
             position: sticky;
             left: 0;
             background-color: #1f2937; 
             z-index: 10; 
             width: auto; 
             min-width: 100px; 
        }
        th.sticky-col.header { 
             background-color: #374151; 
             z-index: 25; 
        }
         thead tr:nth-child(2) th.sticky-col.header { 
            z-index: 26; 
        }
        th, td {
            padding: 8px 10px;
            text-align: left;
            border-bottom: 1px solid #374151; 
            font-size: 0.8rem; 
            vertical-align: top; 
        }
        th:not(.sticky-col):not(:last-child),
        td:not(.equipment-column):not(:last-child),
        .equipment-column:not(:last-child) {
            border-right: 1px solid #374151; 
        }

        .category-separator {
            border-right: 2px solid #4b5563 !important;
        }
        
        .equipment-column { 
            width: 176px; 
            min-width: 176px; 
            white-space: nowrap; 
        }

        .equipment-name {
            font-weight: 700;
            color: #f9fafb; 
            font-size: 0.9rem; 
            margin-bottom: 4px;
            white-space: normal; 
            word-break: keep-all; 
        }
        .rarity-sr {
            display: inline-block;
            background-color: #9333ea; 
            color: white;
            font-size: 0.65rem; 
            font-weight: bold;
            padding: 1px 5px;
            border-radius: 4px;
            margin-left: 6px;
            vertical-align: middle;
        }
        .rarity-lr { 
            display: inline-block;
            background-color: #f59e0b; 
            color: #422006; 
            font-size: 0.65rem;
            font-weight: bold;
            padding: 1px 5px;
            border-radius: 4px;
            margin-left: 6px;
            vertical-align: middle;
        }
        .item-image { 
            width: 105px; 
            height: 105px; 
            background-color: #4b5563; 
            border: 1px solid #6b7280;
            border-radius: 4px;
            display: block; 
            margin: 0 auto 8px auto; 
            object-fit: contain; 
        }
        .level-selector-container {
            margin-top: 4px;
            margin-bottom: 8px;
            text-align: center;
        }
        .level-selector-container label {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-right: 4px;
        }
        .level-selector-container select {
            background-color: #374151;
            color: #e5e7eb;
            border: 1px solid #4b5563;
            border-radius: 4px;
            padding: 2px 4px;
            font-size: 0.75rem;
        }
        .stat-label { 
            color: #9ca3af; 
            font-weight: 500;
        }
        .job-label { 
            color: #cbd5e0; 
            font-weight: 600; 
        }
        .job-row td, .job-row th { 
            background-color: #273344; 
        }
        .job-row th.sticky-col { 
             background-color: #273344 !important; 
        }

        .stat-value {
            color: #e5e7eb; 
            font-weight: 500;
        }
        .stat-value.zero {
            color: #6b7280; 
        }
        .total-stat {
            font-weight: 700;
            color: #34d399; 
        }
        .additional-effects-header {
            background-color: #0c4a6e; 
            color: #bae6fd; 
            font-weight: 600;
            font-size: 0.85rem; 
        }
        .effects-grid-container, .job-icon-grid { 
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr)); 
            gap: 1px; 
            padding: 2px;
            min-height: 75px;
        }
        .effects-column, .job-icon-column { 
            display: flex;
            flex-direction: column;
            gap: 1px; 
        }
        .effect-name, .job-icon-cell span { 
            font-size: 0.7rem; 
            padding: 1px 0;
            line-height: 1.1; 
        }
        .effect-name.active, .job-icon-cell.active span { 
            color: #e5e7eb; 
            opacity: 1;
        }
        .effect-name.inactive { 
            color: #4b5563; 
        }
        
        .job-icon-cell span { 
            color: #e5e7eb; 
        }
        .job-icon-cell.inactive span { 
             opacity: 0.1; 
        }
        .job-icon-cell.fist-active span { 
            opacity: 0.7; 
        }

        .job-icon-cell {
            text-align: center;
            font-size: 0.9rem; 
            line-height: 1.2;
            display: flex; 
            align-items: center;
            justify-content: center;
            min-height: 15px; 
        }
        .category-header {
            background-color: #064e3b; 
            color: #a7f3d0; 
            font-size: 1.1rem; 
            text-align: center !important; 
            padding-top: 8px; 
            padding-bottom: 8px; 
            height: 41px; 
            box-sizing: border-box;
        }
        .category-header.sticky-col { 
             background-color: #374151; 
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="mb-4"> <h1 class="text-2xl font-bold text-gray-100">„Ç∑„ÉïÁ≥ªË£ÖÂÇô „Çπ„ÉÜ„Éº„Çø„Çπ</h1> </div>

    <div class="table-container">
        <table class="min-w-full status-table">
            <thead class="header">
                <tr>
                    <th class="sticky-col header category-header">Ë£ÖÂÇôÁ®ÆÂà•</th>
                    <th colspan="6" class="category-header category-separator">„Éñ„Éº„ÉÑ</th>
                    <th colspan="5" class="category-header category-separator">„Ç¢„Éº„Éû„Éº</th>
                    <th colspan="2" class="category-header category-separator">Â∑¶Êâã</th>
                    <th colspan="7" class="category-header category-separator">Âè≥Êâã</th>
                    <th colspan="6" class="category-header">„Éò„É´„É†</th>
                </tr>
                <tr id="equipmentHeaderRow">
                    <th scope="col" class="sticky-col header">„Çπ„ÉÜ„Éº„Çø„Çπ</th>
                    </tr>
            </thead>
            <tbody id="equipmentTableBody">
                <tr>
                    <th scope="row" class="additional-effects-header sticky-col header">ÊäΩÈÅ∏-ËøΩÂä†ÂäπÊûú</th>
                    </tr>
            </tbody>
        </table>
    </div>

    <script>
        const allPossibleEffects = [ 
            "ÊîªÊíÉ", "Èò≤Âæ°", "ÊîªÈÄü", "ÔΩ∂ÔΩ∞ÔæÑÔæûÂÄ§", "ËÖïÂäõ", "Âô®Áî®", "Áü•Âäõ", "Á≤æÁ•û", "‰ΩìÂäõ", "ÈÄü„Åï", "ÊúÄHP",
            "ÊúÄMP", "Áâ©ÔΩ∏ÔæòÂÄ§", "È≠îÔΩ∏ÔæòÂÄ§", "Áâ©ÔΩ∏ÔæòÂÄç", "È≠îÔΩ∏ÔæòÂÄç", "Èò≤Âäπ", "Ë©†ÈÄü", "ÔΩ∂ÔΩ∞ÔæÑÔæûÂäπ", "Áâ©ËÄê", "È≠îËÄê",
            "ÁÅ´ËÄê", "Ê∞¥ËÄê", "È¢®ËÄê", "ÂúüËÄê", "ÂÖâËÄê", "ÈóáËÄê", "ÔΩ∏ÔæòËÄê", "ÂÇ¨ËÄê", "È∫ªËÄê",
            "ÊØíËÄê", "Ê≤àËÄê", "Ê≥•Áéá"
        ];
        const jobIcons = ["üó°Ô∏è", "üõ°Ô∏è", "üåü", "üíÄ", "ü™Ñ", "üî™", "ü•∑", "‚úä", "üìñ", "‚úùÔ∏è", "", "", "üî±", "‚öîÔ∏è", "üî´"];


        const commonActiveEffectsForBootsAndArmor = [
            "Èò≤Âæ°", "ÔΩ∂ÔΩ∞ÔæÑÔæûÂÄ§", "ËÖïÂäõ", "‰ΩìÂäõ", "ÈÄü„Åï", "ÊúÄMP", "Èò≤Âäπ", "ÔΩ∂ÔΩ∞ÔæÑÔæûÂäπ", "ÁÅ´ËÄê", "Ê∞¥ËÄê", "È¢®ËÄê", "ÂúüËÄê", "ÔΩ∏ÔæòËÄê", "ÂÇ¨ËÄê", "È∫ªËÄê", "ÊØíËÄê", "Ê≤àËÄê"
        ];
        const activeEffectsForLeftHand = [
            "Èò≤Âæ°", "ÔΩ∂ÔΩ∞ÔæÑÔæûÂÄ§", "ËÖïÂäõ", "Âô®Áî®", "Áü•Âäõ", "Á≤æÁ•û", "ÈÄü„Åï", "ÊúÄHP", "Áâ©ÔΩ∏ÔæòÂÄ§", "Èò≤Âäπ", "ÔΩ∂ÔΩ∞ÔæÑÔæûÂäπ", "ÁÅ´ËÄê", "Ê∞¥ËÄê", "È¢®ËÄê", "ÂúüËÄê"
        ];
        const activeEffectsForRightHand = [
            "ÊîªÊíÉ", "ÊîªÈÄü", "ËÖïÂäõ", "Âô®Áî®", "Áü•Âäõ", "Á≤æÁ•û", "ÈÄü„Åï", "ÊúÄHP", "ÊúÄMP", "Áâ©ÔΩ∏ÔæòÂÄ§", "Áâ©ÔΩ∏ÔæòÂÄç", "ÔΩ∂ÔΩ∞ÔæÑÔæûÂäπ", "ÁÅ´ËÄê", "Ê∞¥ËÄê", "È¢®ËÄê", "ÂúüËÄê"
        ];
        const activeEffectsForHelm = [
            "Èò≤Âæ°", "ÔΩ∂ÔΩ∞ÔæÑÔæûÂÄ§", "ËÖïÂäõ", "Âô®Áî®", "Á≤æÁ•û", "‰ΩìÂäõ", "ÊúÄHP", "ÊúÄMP", "ÔΩ∂ÔΩ∞ÔæÑÔæûÂäπ", "ÁÅ´ËÄê", "Ê∞¥ËÄê", "È¢®ËÄê", "ÂúüËÄê", "ÔΩ∏ÔæòËÄê", "ÂÇ¨ËÄê", "È∫ªËÄê", "ÊØíËÄê", "Ê≤àËÄê"
        ];

        const rule1Jobs = ["üó°Ô∏è", "üî™", "‚úä", "üõ°Ô∏è", "ü•∑"]; 
        const rule2Jobs = ["üî™", "‚úä", "ü•∑"]; 
        const rule3Jobs = ["üî™"];
        const rule4Jobs = ["ü•∑"];
        const rule5Jobs = ["‚úä"]; 

        let equipmentData = [ 
            // Boots (6 items now)
            { type: "boots", id: "reidite", name: "ÔæöÔΩ≤ÔæÄÔæûÔΩ≤ÔæÑÔæåÔæûÔΩ∞ÔæÇ", rarity: "SR", imageSrc: "saa.png", baseStats: { HP: 50, MP: 50, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 150, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 120, ‰ΩìÂäõ: 120, ÈÄü„Åï: 100, Áü•Âäõ: 0, Âô®Áî®: 120, Á≤æÁ•û: 0, Á∑èÂêà: 710 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule1Jobs]},
            { type: "boots", id: "ludech", name: "ÔæôÔæÉÔæûÔΩØÔæãÔæåÔæûÔΩ∞ÔæÇ", rarity: "SR", imageSrc: "sab.png", baseStats: { HP: 50, MP: 50, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 190, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 130, ‰ΩìÂäõ: 0, ÈÄü„Åï: 130, Áü•Âäõ: 0, Âô®Áî®: 140, Á≤æÁ•û: 0, Á∑èÂêà: 690 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule1Jobs]},
            { type: "boots", id: "shukufuku", name: "Á•ùÁ¶èÔΩ∂ÔæûÔΩ∞ÔæÑÔæû", rarity: "SR", imageSrc: "sac.png", baseStats: { HP: 211, MP: 100, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 210, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 210, ‰ΩìÂäõ: 220, ÈÄü„Åï: 0, Áü•Âäõ: 0, Âô®Áî®: 200, Á≤æÁ•û: 0, Á∑èÂêà: 1151 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule3Jobs]},
            { type: "boots", id: "origin", name: "ÔΩµÔæòÔΩºÔæûÔæùÔΩ∂ÔæûÔΩ∞ÔæÑÔæû", rarity: "LR", imageSrc: "sad.png", baseStats: { HP: 380, MP: 331, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 270, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 480, ‰ΩìÂäõ: 0, ÈÄü„Åï: 230, Áü•Âäõ: 0, Âô®Áî®: 230, Á≤æÁ•û: 0, Á∑èÂêà: 1921 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule3Jobs]},
            { type: "boots", id: "shukufuku-workpants", name: "Á•ùÁ¶èÔæúÔΩ∞ÔΩ∏ÔæäÔæüÔæùÔæÇ", rarity: "SR", imageSrc: "sae.png", baseStats: { HP: 164, MP: 242, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 210, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 140, ‰ΩìÂäõ: 0, ÈÄü„Åï: 0, Áü•Âäõ: 220, Âô®Áî®: 140, Á≤æÁ•û: 0, Á∑èÂêà: 1116 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule4Jobs]},
            { type: "boots", id: "origin-workpants", name: "ÔΩµÔæòÔΩºÔæûÔæùÔæúÔΩ∞ÔΩ∏ÔæäÔæüÔæùÔæÇ", rarity: "LR", imageSrc: "saf.png", baseStats: { HP: 294, MP: 421, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 260, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 490, ‰ΩìÂäõ: 0, ÈÄü„Åï: 0, Áü•Âäõ: 360, Âô®Áî®: 270, Á≤æÁ•û: 0, Á∑èÂêà: 2095 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule4Jobs]},
            // Armors (5 items) 
            { type: "armor", id: "ludech-brest", name: "ÔæôÔæÉÔæûÔΩØÔæãÔæåÔæûÔæöÔΩΩÔæÑ", rarity: "SR", imageSrc: "sba.png", baseStats: { HP: 50, MP: 50, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 170, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 130, ‰ΩìÂäõ: 0, ÈÄü„Åï: 130, Áü•Âäõ: 0, Âô®Áî®: 140, Á≤æÁ•û: 0, Á∑èÂêà: 670 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule1Jobs]},
            { type: "armor", id: "reidite-plate", name: "ÔæöÔΩ≤ÔæÄÔæûÔΩ≤ÔæÑÔæåÔæüÔæöÔΩ∞ÔæÑ", rarity: "SR", imageSrc: "sbb.png", baseStats: { HP: 50, MP: 50, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 150, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 0, ‰ΩìÂäõ: 150, ÈÄü„Åï: 120, Áü•Âäõ: 0, Âô®Áî®: 120, Á≤æÁ•û: 0, Á∑èÂêà: 640 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule1Jobs]},
            { type: "armor", id: "shukufuku-cloth", name: "Á•ùÁ¶è„ÅÆÔΩ∏ÔæõÔΩ∞ÔΩΩ", rarity: "SR", imageSrc: "sbd.png", baseStats: { HP: 202, MP: 108, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 220, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 260, ‰ΩìÂäõ: 0, ÈÄü„Åï: 130, Áü•Âäõ: 0, Âô®Áî®: 260, Á≤æÁ•û: 0, Á∑èÂêà: 1180 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule3Jobs]},
            { type: "armor", id: "origin-cloth", name: "ÔΩµÔæòÔΩºÔæûÔæùÔΩ∏ÔæõÔΩ∞ÔΩΩ", rarity: "LR", imageSrc: "sbe.png", baseStats: { HP: 380, MP: 321, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 300, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 500, ‰ΩìÂäõ: 0, ÈÄü„Åï: 0, Áü•Âäõ: 0, Âô®Áî®: 480, Á≤æÁ•û: 0, Á∑èÂêà: 1981 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule3Jobs]},
            { type: "armor", id: "shukufuku-workcloth", name: "Á•ùÁ¶è„ÅÆÔæúÔΩ∞ÔΩ∏ÔΩ∏ÔæõÔΩ∞ÔΩΩ", rarity: "SR", imageSrc: "sbc.png", baseStats: { HP: 242, MP: 161, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 220, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 240, ‰ΩìÂäõ: 0, ÈÄü„Åï: 160, Áü•Âäõ: 0, Âô®Áî®: 120, Á≤æÁ•û: 0, Á∑èÂêà: 1143 }, activeEffects: [...commonActiveEffectsForBootsAndArmor], equipableJobs: [...rule4Jobs]},
            // Left Hand (2 items)
            { type: "lefthand", id: "greed-rock", name: "ÔΩ∏ÔæûÔæòÔΩ∞ÔæÑÔæûÔæõÔΩØÔΩ∏", rarity: "SR", imageSrc: "sca.png", baseStats: { HP: 103, MP: 173, ÊîªÊíÉÂäõ: 290, Èò≤Âæ°Âäõ: 150, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 9, „Ç¨„Éº„Éâ: 15, ËÖïÂäõ: 220, ‰ΩìÂäõ: 150, ÈÄü„Åï: 0, Áü•Âäõ: 140, Âô®Áî®: 0, Á≤æÁ•û: 0, Á∑èÂêà: 1250 }, activeEffects: [...activeEffectsForLeftHand], equipableJobs: [...rule2Jobs]},
            { type: "lefthand", id: "another-style-sai", name: "ÔΩ±ÔæÖÔΩªÔæûÔΩ∞ÔΩΩÔæÄÔΩ≤ÔæôÔΩªÔΩ≤", rarity: "SR", imageSrc: "scb.png", baseStats: { HP: 44, MP: 266, ÊîªÊíÉÂäõ: 420, Èò≤Âæ°Âäõ: 80, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 10, „Ç¨„Éº„Éâ: 3, ËÖïÂäõ: 170, ‰ΩìÂäõ: 0, ÈÄü„Åï: 0, Áü•Âäõ: 120, Âô®Áî®: 80, Á≤æÁ•û: 160, Á∑èÂêà: 1353 }, activeEffects: [...activeEffectsForLeftHand], equipableJobs: [...rule2Jobs]},
            // Right Hand (7 items)
            { type: "righthand", id: "greeder-style", name: "ÔΩ∏ÔæûÔæòÔΩ∞ÔæÄÔæûÔΩ∞ÔΩΩÔæÄÔΩ≤Ôæô", rarity: "SR", imageSrc: "sda.png", baseStats: { HP: 220, MP: 165, ÊîªÊíÉÂäõ: 420, Èò≤Âæ°Âäõ: 0, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 204, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 180, ‰ΩìÂäõ: 0, ÈÄü„Åï: 320, Áü•Âäõ: 0, Âô®Áî®: 340, Á≤æÁ•û: 0, Á∑èÂêà: 1849 }, activeEffects: [...activeEffectsForRightHand], equipableJobs: [...rule3Jobs]},
            { type: "righthand", id: "another-style-dagger", name: "ÔΩ±ÔæÖÔΩªÔæûÔΩ∞ÔΩΩÔæÄÔΩ≤ÔæôÔæÄÔæûÔΩ∂ÔæûÔΩ∞", rarity: "SR", imageSrc: "sdb.png", baseStats: { HP: 144, MP: 220, ÊîªÊíÉÂäõ: 440, Èò≤Âæ°Âäõ: 0, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 184, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 160, ‰ΩìÂäõ: 0, ÈÄü„Åï: 130, Áü•Âäõ: 0, Âô®Áî®: 180, Á≤æÁ•û: 340, Á∑èÂêà: 1798 }, activeEffects: [...activeEffectsForRightHand], equipableJobs: [...rule3Jobs]},
            { type: "righthand", id: "murder-trap", name: "ÔæèÔΩ∞ÔæÄÔæûÔΩ∞ÔæÑÔæóÔΩØÔæåÔæü", rarity: "LR", imageSrc: "sdc.png", baseStats: { HP: 330, MP: 247, ÊîªÊíÉÂäõ: 550, Èò≤Âæ°Âäõ: 0, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 239, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 270, ‰ΩìÂäõ: 0, ÈÄü„Åï: 410, Áü•Âäõ: 0, Âô®Áî®: 440, Á≤æÁ•û: 0, Á∑èÂêà: 2486 }, activeEffects: [...activeEffectsForRightHand], equipableJobs: [...rule3Jobs]},
            { type: "righthand", id: "uraus-trenge", name: "ÔΩ≥ÔæóÔΩ≥ÔΩΩÔæÑÔæöÔæùÔΩºÔæû", rarity: "SR", imageSrc: "sdd.png", baseStats: { HP: 0, MP: 171, ÊîªÊíÉÂäõ: 420, Èò≤Âæ°Âäõ: 0, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 12, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 370, ‰ΩìÂäõ: 0, ÈÄü„Åï: 340, Áü•Âäõ: 0, Âô®Áî®: 260, Á≤æÁ•û: 0, Á∑èÂêà: 1573 }, activeEffects: [...activeEffectsForRightHand], equipableJobs: [...rule4Jobs]},
            { type: "righthand", id: "another-style-taro", name: "ÔΩ±ÔæÖÔΩªÔæûÔΩ∞ÔΩΩÔæÄÔΩ≤ÔæôÔæÄÔæõÔΩ∞", rarity: "SR", imageSrc: "sde.png", baseStats: { HP: 0, MP: 220, ÊîªÊíÉÂäõ: 520, Èò≤Âæ°Âäõ: 0, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 12, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 450, ‰ΩìÂäõ: 0, ÈÄü„Åï: 0, Áü•Âäõ: 240, Âô®Áî®: 180, Á≤æÁ•û: 0, Á∑èÂêà: 1622 }, activeEffects: [...activeEffectsForRightHand], equipableJobs: [...rule4Jobs]},
            { type: "righthand", id: "glatnics-ha", name: "ÔΩ∏ÔæûÔæóÔæÑÔæÜÔΩ∏ÔΩΩ„ÉªÁ†¥", rarity: "SR", imageSrc: "sdf.png", baseStats: { HP: 293, MP: 183, ÊîªÊíÉÂäõ: 420, Èò≤Âæ°Âäõ: 0, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 18, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 380, ‰ΩìÂäõ: 170, ÈÄü„Åï: 130, Áü•Âäõ: 0, Âô®Áî®: 0, Á≤æÁ•û: 0, Á∑èÂêà: 1594 }, activeEffects: [...activeEffectsForRightHand], equipableJobs: [...rule5Jobs]},
            { type: "righthand", id: "another-style-knuckle", name: "ÔΩ±ÔæÖÔΩªÔæûÔΩ∞ÔΩΩÔæÄÔΩ≤ÔæôÔæÖÔΩØÔΩ∏Ôæô", rarity: "SR", imageSrc: "sdg.png", baseStats: { HP: 174, MP: 240, ÊîªÊíÉÂäõ: 440, Èò≤Âæ°Âäõ: 0, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 18, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 190, ‰ΩìÂäõ: 100, ÈÄü„Åï: 0, Áü•Âäõ: 0, Âô®Áî®: 200, Á≤æÁ•û: 220, Á∑èÂêà: 1582 }, activeEffects: [...activeEffectsForRightHand], equipableJobs: [...rule5Jobs]},
            // Helms (6 items now)
            { type: "helm", id: "ludech-grim", name: "ÔæôÔæÉÔæûÔΩØÔæãÔΩ∏ÔæûÔæòÔæë", rarity: "SR", imageSrc: "sea.png", baseStats: { HP: 50, MP: 0, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 140, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 130, ‰ΩìÂäõ: 0, ÈÄü„Åï: 130, Áü•Âäõ: 0, Âô®Áî®: 140, Á≤æÁ•û: 0, Á∑èÂêà: 640 }, activeEffects: [...activeEffectsForHelm], equipableJobs: [...rule1Jobs]},
            { type: "helm", id: "reidite-helm", name: "ÔæöÔΩ≤ÔæÄÔæûÔΩ≤ÔæÑÔæçÔæôÔæë", rarity: "SR", imageSrc: "seb.png", baseStats: { HP: 50, MP: 0, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 140, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 110, ‰ΩìÂäõ: 110, ÈÄü„Åï: 70, Áü•Âäõ: 0, Âô®Áî®: 110, Á≤æÁ•û: 0, Á∑èÂêà: 640 }, activeEffects: [...activeEffectsForHelm], equipableJobs: [...rule1Jobs]},
            { type: "helm", id: "qey-hat", name: "ÔΩ∏ÔΩ™ÔΩ≤ÔΩ∞ÔæÑÔæäÔΩØÔæÑ", rarity: "SR", imageSrc: "sec.png", baseStats: { HP: 103, MP: 173, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 150, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 250, ‰ΩìÂäõ: 150, ÈÄü„Åï: 0, Áü•Âäõ: 150, Âô®Áî®: 0, Á≤æÁ•û: 0, Á∑èÂêà: 1226 }, activeEffects: [...activeEffectsForHelm], equipableJobs: [...rule2Jobs]}, // ËÖïÂäõ 0->250, Á∑èÂêà 976->1226
            { type: "helm", id: "second-hat", name: "2ndÔæäÔΩØÔæÑ", rarity: "SR", imageSrc: "sef.png", baseStats: { HP: 61, MP: 201, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 150, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 180, ‰ΩìÂäõ: 120, ÈÄü„Åï: 0, Áü•Âäõ: 0, Âô®Áî®: 120, Á≤æÁ•û: 150, Á∑èÂêà: 982 }, activeEffects: [...activeEffectsForHelm], equipableJobs: [...rule2Jobs]},
            { type: "helm", id: "defy-cap", name: "ÔæÉÔæûÔΩ®ÔæåÔΩßÔΩ≤ÔΩ∑ÔΩ¨ÔΩØÔæåÔæü", rarity: "LR", imageSrc: "sed.png", baseStats: { HP: 211, MP: 211, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 270, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 320, ‰ΩìÂäõ: 310, ÈÄü„Åï: 0, Áü•Âäõ: 0, Âô®Áî®: 320, Á≤æÁ•û: 0, Á∑èÂêà: 1642 }, activeEffects: [...activeEffectsForHelm], equipableJobs: [...rule3Jobs]},
            { type: "helm", id: "starlight-cap", name: "ÔΩΩÔæÄÔΩ∞ÔæóÔΩ≤ÔæÑÔΩ∑ÔΩ¨ÔΩØÔæåÔæü", rarity: "LR", imageSrc: "see.png", baseStats: { HP: 201, MP: 301, ÊîªÊíÉÂäõ: 0, Èò≤Âæ°Âäõ: 250, È≠îÊ≥ïÊîªÊíÉÂäõ: 0, ÊîªÊíÉÈÄüÂ∫¶: 0, „Ç¨„Éº„Éâ: 0, ËÖïÂäõ: 330, ‰ΩìÂäõ: 240, ÈÄü„Åï: 190, Áü•Âäõ: 0, Âô®Áî®: 220, Á≤æÁ•û: 0, Á∑èÂêà: 1732 }, activeEffects: [...activeEffectsForHelm], equipableJobs: [...rule3Jobs]}
        ];
        
        // Reorder armor
        const armorItems = equipmentData.filter(eq => eq.type === "armor");
        const shukufukuWorkclothArmor = armorItems.find(eq => eq.id === "shukufuku-workcloth");
        const originClothArmorIndex = armorItems.findIndex(eq => eq.id === "origin-cloth");
        if (shukufukuWorkclothArmor && originClothArmorIndex !== -1) {
            const currentIndex = armorItems.indexOf(shukufukuWorkclothArmor);
            if (currentIndex !== -1 && currentIndex !== originClothArmorIndex + 1) {
                armorItems.splice(currentIndex, 1);
                armorItems.splice(originClothArmorIndex + 1, 0, shukufukuWorkclothArmor);
            }
        }
        
        // Reconstruct equipmentData with reordered items
        const bootsItemsReordered = equipmentData.filter(eq => eq.type === "boots");
        const leftHandItemsReordered = equipmentData.filter(eq => eq.type === "lefthand");
        const rightHandItemsReordered = equipmentData.filter(eq => eq.type === "righthand");
        const helmItemsReordered = equipmentData.filter(eq => eq.type === "helm");

        equipmentData = [
            ...bootsItemsReordered,
            ...armorItems, 
            ...leftHandItemsReordered,
            ...rightHandItemsReordered,
            ...helmItemsReordered
        ];


        equipmentData.forEach(eq => {
            eq.currentLevel = 0;
            let initialTotal = 0;
            for (const statName in eq.baseStats) {
                if (statName !== "Á∑èÂêà") {
                    initialTotal += eq.baseStats[statName];
                }
            }
            // If baseStats.Á∑èÂêà is not explicitly set OR is 0 (and likely needs calculation), calculate it.
            if (eq.baseStats["Á∑èÂêà"] === undefined || eq.baseStats["Á∑èÂêà"] === 0 ) { 
                 eq.baseStats["Á∑èÂêà"] = initialTotal;
            }
            eq.calculatedStats = { ...eq.baseStats }; 
        });

        const statLabels = ["HP", "MP", "ÊîªÊíÉÂäõ", "Èò≤Âæ°Âäõ", "È≠îÊ≥ïÊîªÊíÉÂäõ", "ÊîªÊíÉÈÄüÂ∫¶", "„Ç¨„Éº„Éâ", "ËÖïÂäõ", "‰ΩìÂäõ", "ÈÄü„Åï", "Áü•Âäõ", "Âô®Áî®", "Á≤æÁ•û", "Á∑èÂêà"];
        const equipmentHeaderRow = document.getElementById('equipmentHeaderRow');
        const tableBody = document.getElementById('equipmentTableBody');
        const additionalEffectsHeaderRow = tableBody.querySelector('tr:has(th.additional-effects-header)');
        
        equipmentData.forEach((eq, index) => {
            const th = document.createElement('th');
            th.scope = "col";
            th.className = "text-center equipment-column"; 
            // Boots: 6, Armor: 5, Left Hand: 2, Right Hand: 7, Helm: 6
            if ( (index === 5) ||  // After last Boot
                 (index === 10) ||  // After last Armor
                 (index === 12)||  // After last Left Hand
                 (index === 19) ) { // After last Right Hand
                th.classList.add('category-separator');
            }

            const nameDiv = document.createElement('div');
            nameDiv.className = "equipment-name";
            nameDiv.innerHTML = `${eq.name} <span class="rarity-${eq.rarity.toLowerCase()}">${eq.rarity}</span>`;
            th.appendChild(nameDiv);

            const img = document.createElement('img');
            img.src = eq.imageSrc;
            img.alt = eq.name;
            img.className = "item-image";
            th.appendChild(img);

            const levelContainer = document.createElement('div');
            levelContainer.className = "level-selector-container";
            const levelLabel = document.createElement('label');
            levelLabel.htmlFor = `level-${eq.id}`;
            levelLabel.textContent = "Lv.";
            levelContainer.appendChild(levelLabel);

            const levelSelect = document.createElement('select');
            levelSelect.id = `level-${eq.id}`;
            levelSelect.className = "level-select";
            const maxLevel = eq.rarity === "LR" ? 80 : 45;
            for (let i = 0; i <= maxLevel; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                levelSelect.appendChild(option);
            }
            levelSelect.addEventListener('change', (event) => handleLevelChange(index, parseInt(event.target.value)));
            levelContainer.appendChild(levelSelect);
            th.appendChild(levelContainer);

            equipmentHeaderRow.appendChild(th);

            const effectsCell = document.createElement('td');
            effectsCell.id = `effects-${eq.id}`;
            effectsCell.className = 'effects-cell equipment-column'; 
             if ( (index === 5) ||  
                 (index === 10) ||  
                 (index === 12) || 
                 (index === 19) ) { 
                effectsCell.classList.add('category-separator');
            }
            additionalEffectsHeaderRow.appendChild(effectsCell);
        });


        function calculateStatValue(baseStat, level, statName) {
            if (statName === "ÊîªÊíÉÈÄüÂ∫¶") { 
                return baseStat; 
            }
            if (baseStat === 0 && statName !== "Á∑èÂêà") return 0; 
            // For "Á∑èÂêà", we will calculate it based on other stats, so we don't apply level growth here directly.
            // Instead, the base value of "Á∑èÂêà" (which should be pre-calculated for Lv0) is used.
            // The actual sum will be done in recalculateAndDisplayStats.
            if (statName === "Á∑èÂêà") return baseStat; 

            const growthPerLevel = baseStat * 0.09;
            return Math.ceil(baseStat + (growthPerLevel * level));
        }

        function recalculateAndDisplayStats(equipmentIndex) {
            const eq = equipmentData[equipmentIndex];
            let currentTotal = 0;

            statLabels.forEach(label => {
                if (label === "Á∑èÂêà") return; 
                const base = eq.baseStats[label];
                const calculatedValue = calculateStatValue(base, eq.currentLevel, label);
                eq.calculatedStats[label] = calculatedValue;
                if (typeof calculatedValue === 'number') { 
                    currentTotal += calculatedValue;
                }
            });
            eq.calculatedStats["Á∑èÂêà"] = currentTotal; // Update "Á∑èÂêà" with the sum of other calculated stats

            updateTableDisplayForEquipment(equipmentIndex);
        }

        function updateTableDisplayForEquipment(equipmentIndex) {
            const eq = equipmentData[equipmentIndex];
            const statRows = tableBody.querySelectorAll('tr:not(:has(th.additional-effects-header)):not(#jobRow)'); 

            statRows.forEach(row => {
                const labelCell = row.querySelector('th.stat-label');
                if (!labelCell) return; 
                const statName = labelCell.textContent;
                const valueCell = row.querySelectorAll('td.stat-value')[equipmentIndex]; 
                if (valueCell && eq.calculatedStats[statName] !== undefined) {
                    const value = eq.calculatedStats[statName];
                    valueCell.textContent = value;
                    valueCell.classList.toggle('zero', value === 0 && statName !== 'Á∑èÂêà');
                    valueCell.classList.toggle('total-stat', statName === 'Á∑èÂêà');
                }
            });
        }
        
        function handleLevelChange(equipmentIndex, selectedLevel) {
            equipmentData[equipmentIndex].currentLevel = selectedLevel;
            recalculateAndDisplayStats(equipmentIndex);
        }

        // Generate Job Icons Row
        const jobRow = document.createElement('tr');
        jobRow.id = "jobRow";
        jobRow.className = "job-row"; 
        const jobTh = document.createElement('th');
        jobTh.scope = "row";
        jobTh.className = "job-label sticky-col"; 
        jobTh.textContent = "ËÅ∑Ê•≠";
        jobRow.appendChild(jobTh);

        equipmentData.forEach((eq, eqIndex) => {
            const jobTd = document.createElement('td');
            jobTd.className = 'equipment-column'; 
            if ( (eqIndex === 5) ||  
                 (eqIndex === 10) ||  
                 (eqIndex === 12) || 
                 (eqIndex === 19) ) { 
                jobTd.classList.add('category-separator');
            }

            const jobGridContainer = document.createElement('div');
            jobGridContainer.className = 'job-icon-grid';

            for (let i = 0; i < 15; i++) { 
                const iconCell = document.createElement('div');
                iconCell.className = 'job-icon-cell';
                const currentIcon = jobIcons[i]; 

                if (currentIcon && currentIcon !== "") { 
                    const iconSpan = document.createElement('span');
                    iconSpan.textContent = currentIcon;
                    const isEquipable = eq.equipableJobs.includes(currentIcon);
                    
                    if (currentIcon === "‚úä") {
                        if (isEquipable) {
                            iconCell.classList.add('fist-active'); 
                        } else {
                            iconCell.classList.add('inactive'); 
                        }
                    } else {
                        if (isEquipable) {
                            iconCell.classList.add('active');
                        } else {
                            iconCell.classList.add('inactive');
                        }
                    }
                    iconCell.appendChild(iconSpan);
                } else {
                    iconCell.innerHTML = '&nbsp;'; 
                }
                jobGridContainer.appendChild(iconCell);
            }
            jobTd.appendChild(jobGridContainer);
            jobRow.appendChild(jobTd);
        });
        tableBody.insertBefore(jobRow, tableBody.firstChild); 


        // Generate rows for basic stats (initial display)
        statLabels.forEach(label => {
            const row = document.createElement('tr');
            const th = document.createElement('th');
            th.scope = "row";
            th.className = "stat-label sticky-col";
            th.textContent = label;
            row.appendChild(th);

            equipmentData.forEach((eq, eqIndex) => {
                const td = document.createElement('td');
                td.className = `stat-value text-center equipment-column`; 
                const value = eq.calculatedStats[label] !== undefined ? eq.calculatedStats[label] : '-';
                if (value === 0 && label !== 'Á∑èÂêà') td.classList.add('zero');
                if (label === 'Á∑èÂêà') td.classList.add('total-stat');
                
                if ( (eqIndex === 5) ||  
                     (eqIndex === 10) ||  
                     (eqIndex === 12) || 
                     (eqIndex === 19) ) { 
                    td.classList.add('category-separator');
                }
                td.textContent = value;
                row.appendChild(td);
            });
            tableBody.insertBefore(row, additionalEffectsHeaderRow); 
        });

        // Generate additional effects display for each equipment
        equipmentData.forEach((eq, eqIndex) => {
            const cellId = `effects-${eq.id}`;
            const effectsCell = document.getElementById(cellId);
            if (!effectsCell) { 
                console.error(`Cell with ID ${cellId} not found for effects.`);
                return;
            }
            
            const gridContainer = document.createElement('div');
            gridContainer.className = 'effects-grid-container';

            const columns = [[], [], []]; 
            allPossibleEffects.forEach((effectName, index) => {
                columns[index % 3].push(effectName);
            });

            columns.forEach(columnEffects => {
                const columnDiv = document.createElement('div');
                columnDiv.className = 'effects-column';
                columnEffects.forEach(effectName => {
                    const effectDiv = document.createElement('div');
                    effectDiv.textContent = effectName;
                    const isActive = eq.activeEffects.includes(effectName);
                    effectDiv.className = `effect-name ${isActive ? 'active' : 'inactive'}`;
                    columnDiv.appendChild(effectDiv);
                });
                gridContainer.appendChild(columnDiv);
            });
            effectsCell.appendChild(gridContainer);
        });
        
        equipmentData.forEach((eq, index) => {
            recalculateAndDisplayStats(index); 
        });

    </script>
</body>
</html>